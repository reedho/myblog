+++
title = "Babashka `bb` and Not Babashka `nbb`"
date = 2024-08-10
+++

## bb

Babashka [Home](https://babashka.org),
[Github](https://github.com/babashka/babashka).

> Babashka is a native Clojure interpreter for scripting with fast startup. Its
> main goal is to leverage Clojure in places where you would be using bash
> otherwise.

### TLDR;

```bash
bb -e '(+ 1 20)'
bb -e '(-> (org.httpkit.client/get "https://datafy.id") deref :status)'
bb tasks

cat <<EOF > bb.edn
{:tasks {hello (println "hello there")}}
EOF

bb hello # run the task named hello
```

## nbb

Not Babashka [`nbb`](https://github.com/babashka/babashka) is `bb` atop JS
runtime, e.g. [bun](https://bun.sh/) or [nodejs](https://nodejs.org/en).

### Getting Started

```bash
# Using bun, this will automatically download nbb if necessary
# and compute bcrypt hash of given password
bunx --bun nbb -e '(js/Bun.password.hash "pass" #js {:algorithm "bcrypt"})'
```

We can make it more organized by creating config file `nbb.edn` and create a
cljs file.

```bash
mkdir x && cd x
touch nbb.edn
touch hello.cljs
```

Config file `nbb.edn` could be as simple as this:

```clojure
{:paths ["."]}
```

And the `hello.cljs` content, for example shown here, we will use `bun` hash
api.

```clojure
(ns hello)

(defn greeting [& {:keys [to]}]
  (println (str "Hello " to)))

(defn -main [& [password]]
  ;; note that if we return promise, it will be automatically waited
  ;; and then result is printed
  (js/Bun.password.hash password #js {:algorithm "bcrypt"}))

(defn bcrypt [& {:keys [password]
                 :or {password "pass"}}]
  (-> (js/Bun.password.hash password #js {:algorithm "bcrypt"})
      (.then (fn [x]
               {:password password
                :hash x}))))
```

With these two files, now we could execute the script with nbb like this:

```bash
bunx --bun nbb -x hello/greeting --to "Ridho"
bunx --bun nbb -x hello/bcrypt --password your_strong_password
bunx --bun nbb -x hello/bcrypt :password "your_strong_password" # same like above
bunx --bun nbb -m hello your_strong_password
```
